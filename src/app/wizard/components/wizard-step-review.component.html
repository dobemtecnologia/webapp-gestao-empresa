<div class="review-summary">
  <ion-card>
    <ion-card-header>
      <ion-card-title>Resumo do Plano</ion-card-title>
      @if (resumoPeriodo) {
        <div class="highlight-price">
          <div class="price-label">Valor do plano para o período {{ resumoPeriodo.labelPeriodo }}</div>
          <div class="price-value">{{ formatarMoeda(resumoPeriodo.precoPeriodoComDesconto) }}</div>
          <div class="price-sub">equivalente a {{ formatarMoeda(resumoPeriodo.precoMensalComDesconto) }} / mês</div>
        </div>
      }
    </ion-card-header>
    <ion-card-content>
      <!-- Tabela de valores do período -->
      @if (resumoPeriodo) {
        <div class="summary-table">
          <table>
            <tbody>
              <tr>
                <th>Período selecionado</th>
                <td>{{ resumoPeriodo.labelPeriodo }} ({{ resumoPeriodo.meses }} meses)</td>
              </tr>
              <tr>
                <th>Mensalidade base (sem desconto)</th>
                <td>{{ formatarMoeda(resumoPeriodo.precoMensalBase) }}</td>
              </tr>
              <tr>
                <th>Valor do período (sem desconto)</th>
                <td>{{ formatarMoeda(resumoPeriodo.precoPeriodoBruto) }}</td>
              </tr>
              <tr>
                <th>Desconto aplicado</th>
                <td>
                  @if (resumoPeriodo.descontoPercentual > 0) {
                    {{ resumoPeriodo.descontoPercentual }}% ({{ formatarMoeda(resumoPeriodo.valorDesconto) }})
                  } @else {
                    Sem desconto
                  }
                </td>
              </tr>
              <tr>
                <th>Valor final do período</th>
                <td><strong>{{ formatarMoeda(resumoPeriodo.precoPeriodoComDesconto) }}</strong></td>
              </tr>
              <tr>
                <th>Equivalente mensal com desconto</th>
                <td>{{ formatarMoeda(resumoPeriodo.precoMensalComDesconto) }}</td>
              </tr>
            </tbody>
          </table>
        </div>
      }

      <!-- Tabela de configuração do plano -->
      <div class="summary-table">
        <h3>Configuração do Plano</h3>
        <table>
          <tbody>
            <tr>
              <th>Setores selecionados</th>
              <td>
                @for (sector of selectedSectors(); track sector) {
                  <ion-chip>{{ sector }}</ion-chip>
                }
              </td>
            </tr>
            <tr>
              <th>Assistentes</th>
              <td>
                <table class="inner-table">
                  <thead>
                    <tr>
                      <th>Assistente</th>
                      <th>Setor</th>
                      <th>Quantidade</th>
                    </tr>
                  </thead>
                  <tbody>
                    @for (assistant of assistants(); track assistant.id + assistant.sector) {
                      @if (assistant.quantity > 0) {
                        <tr>
                          <td>{{ getAssistantName(assistant.id) }}</td>
                          <td>{{ assistant.sector }}</td>
                          <td>{{ assistant.quantity }}</td>
                        </tr>
                      }
                    }
                  </tbody>
                </table>
              </td>
            </tr>
            <tr>
              <th>Canais ativos</th>
              <td>
                <table class="inner-table">
                  <thead>
                    <tr>
                      <th>Canal</th>
                    </tr>
                  </thead>
                  <tbody>
                    @for (channel of channels(); track channel.id) {
                      @if (channel.enabled) {
                        <tr>
                          <td>{{ getChannelName(channel.id) }}</td>
                        </tr>
                      }
                    }
                  </tbody>
                </table>
              </td>
            </tr>
            @if (infrastructure()) {
              <tr>
                <th>Infraestrutura</th>
                <td>{{ getInfrastructureName(infrastructure()!) }}</td>
              </tr>
            }
            <tr>
              <th>Consumo estimado</th>
              <td>
                <div>
                  <strong>Mensagens WhatsApp:</strong> {{ formatarNumero(monthlyCredits()) }} / mês
                </div>
                <div>
                  <strong>Tokens OpenAI:</strong> {{ formatarNumero(tokensOpenAi()) }} / mês
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </ion-card-content>
  </ion-card>
</div>
